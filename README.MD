# An√°lise de Sentimentos em Evolu√ß√£o de Software

## üìã Tutorial da Atividade

O tutorial completo com as instru√ß√µes passo a passo para realizar esta atividade est√° dispon√≠vel em PDF:

[üìñ **Acessar Tutorial em PDF**](./Douglas_Deda_Gabriel_Almeida_Henrick_Cardoso_Ian_Concei√ß√£o_Mariana_Nunes_Pablo_Freire_Rafael_Oliveira_Yasmim_Lima_Atividade_1.pdf)

## üì∞ Projeto
- [**ChatTTS**](https://github.com/2noise/ChatTTS)

## ü§ñ Modelos

- [**Roberta**](https://huggingface.co/cardiffnlp/twitter-roberta-base-sentiment)
- [**Bertweet**](https://huggingface.co/finiteautomata/bertweet-base-sentiment-analysis)
- [**Multilingual**](https://huggingface.co/tabularisai/multilingual-sentiment-analysis)

## Estrutura do Projeto

    .
    ‚îú‚îÄ‚îÄ README.md
    ‚îú‚îÄ‚îÄ requirements.txt
    ‚îî‚îÄ‚îÄ src
        ‚îú‚îÄ‚îÄ main.py
        ‚îú‚îÄ‚îÄ PRs_comments
        ‚îÇ   ‚îî‚îÄ‚îÄ extract_pr_comments.py
        ‚îú‚îÄ‚îÄ models
        ‚îÇ   ‚îú‚îÄ‚îÄ BERTweet
        ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ analise_bertweet.py
        ‚îÇ   ‚îú‚îÄ‚îÄ Multilingual
        ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ analyzeMultilingual.py
        ‚îÇ   ‚îî‚îÄ‚îÄ Roberta
        ‚îÇ       ‚îî‚îÄ‚îÄ analyzeRobertaBase.py
        ‚îî‚îÄ‚îÄ results
            ‚îú‚îÄ‚îÄ bertweet_sentiment_results.json
            ‚îú‚îÄ‚îÄ multilingual_sentiment_results.json
            ‚îî‚îÄ‚îÄ roberta_sentiment_results.json
O arquivo pr_comments_2noise_ChatTTS_closed_nobots_True.json j√° cont√©m os coment√°rios dos PRs do ChatTTS que ser√£o analisados pelos modelos.

## Pr√©-requisitos

Antes de rodar qualquer coisa, voc√™ vai precisar de:

- **Python 3.9+**
- **pip** (gerenciador de pacotes do Python)
- **Git** (para clonar o reposit√≥rio)

## Fluxo resumido de execu√ß√£o
1. Clonar o reposit√≥rio e instalar depend√™ncias.
2. Garantir que o arquivo `"src/PRs_comments/pr_comments_2noise_ChatTTS_closed_nobots_True.json"` est√° presente (j√° inclu√≠do no projeto).
3. Executar:
¬¥¬¥¬¥bash
cd src
python main.py
¬¥¬¥¬¥
4. Analisar os resultados em `"src/results/*.json."`
5. Coleta de coment√°rios de PRs de outro reposit√≥rio(opcional)


## 1. Instala√ß√£o do Projeto

### 1.1. Clonar o reposit√≥rio
```bash
    git clone https://github.com/faalkor/Evolucao_Software_2025-2_chatTTS.git
    cd Evolucao_Software_2025-2_chatTTS
```
### 1.2. Instalar depend√™ncias
```bash
    pip install -r requirements.txt
```

## 2. Como executar os modelos
Os coment√°rios dos PRs j√° est√£o armazenados em:
```txt
src/PRs_comments/pr_comments_2noise_ChatTTS_closed_nobots_True.json
```
Os tr√™s modelos l√™em esse arquivo automaticamente por meio da configura√ß√£o:

```python
INPUT_FILE = os.path.join(
    BASE_DIR,
    '..',
    "PRs_comments",
    "pr_comments_2noise_ChatTTS_closed_nobots_True.json"
)
```

### 2.1. Execu√ß√£o unificada via main.py
O script `"src/main.py"` executa os tr√™s modelos em sequ√™ncia:
```python
from models.BERTweet.analise_bertweet import run_bertweet
from models.Multilingual.analyzeMultilingual import run_multilingual
from models.Roberta.analyzeRobertaBase import run_roberta
```
Para rodar a an√°lise completa:

```bash
cd src
python main.py
# ou python3 main.py
```

Na primeira execu√ß√£o, a biblioteca `"transformers"` ir√° baixar os modelos do Hugging Face.
Isso pode levar alguns minutos, dependendo da conex√£o.

Ao final, ser√£o criados/atualizados os arquivos:
```text
src/results/bertweet_sentiment_results.json
src/results/multilingual_sentiment_results.json
src/results/roberta_sentiment_results.json
```
## 3. Formato dos arquivos de sa√≠da
Cada arquivo de resultados `"(*_sentiment_results.json)"` cont√©m uma lista de objetos, um por coment√°rio analisado.
Cada objeto tem a estrutura:
```json
{
  "pr_number": 123,
  "user": "login_do_usuario",
  "text": "conte√∫do do coment√°rio...",
  "label": "POSITIVE | NEUTRAL | NEGATIVE",
  "score": 0.987
}
```
- `"pr_number"`: n√∫mero do pull request ao qual o coment√°rio pertence
- `"user"`: autor do coment√°rio
- `"text"`: texto do coment√°rio (possivelmente truncado, ver se√ß√£o 6)
- `"label"`: sentimento dominante atribu√≠do pelo modelo
- `"score"`: confian√ßa do modelo na classifica√ß√£o (probabilidade aproximada)

Al√©m disso, cada script imprime no terminal um resumo com a contagem de coment√°rios por classe de sentimento.

## 5. (Opcional) Coleta de coment√°rios de PRs de outro reposit√≥rio
Caso voc√™ queira reaplicar a pipeline de an√°lise de sentimentos em qualquer outro reposit√≥rio do GitHub, pode usar o script:
```text
src/PRs_comments/extract_pr_comments.py
```
Esse script:
- busca pull requests de um reposit√≥rio espec√≠fico;
- filtra bots;
- coleta coment√°rios gerais e coment√°rios de review;
- salva tudo em um √∫nico arquivo `".json."`

### 5.1. Requisitos extras

Para essa etapa opcional, √© necess√°rio:
- **Token de acesso pessoal do GitHub** com permiss√£o de leitura em reposit√≥rios p√∫blicos(ou privados, se for analisar projetos privados da sua conta/org)
#### Como criar um token de acesso pessoal no GitHub (PAT)

1. Acesse: *Settings* > *Developer settings* > *Personal access tokens*.
2. Crie um novo token (fine-grained ou classic).
3. D√™ permiss√£o de leitura para:
   - `public_repo` (para reposit√≥rios p√∫blicos)  
   - e/ou permiss√µes de leitura em reposit√≥rios privados, se necess√°rio.
4. Copie o token gerado e guarde em local seguro.

### 5.2. Configurar o reposit√≥rio a ser analisado

```text
src/PRs_comments/extract_pr_comments.py
```
No final do arquivo, dentro da fun√ß√£o `"main()"`, localize:
```python
def main():
    # CONFIGURA√á√ïES
    GITHUB_TOKEN = "seu_token"  # Token de acesso pessoal do GitHub
    REPO_OWNER = "owner_repositorio"  # Ex: "facebook"
    REPO_NAME = "nome_repositorio"  # Ex: "react"
```
Substitua:
- `""seu_token""` pelo seu token do GitHub;
- `""owner_repositorio""` pelo owner do reposit√≥rio (usu√°rio ou organiza√ß√£o);
- `""nome_repositorio""` pelo nome do reposit√≥rio.
Exemplo para o projeto ChatTTS oficial:
```python
GITHUB_TOKEN = "ghp_xxxSEUTOKENAQUIxxx"
REPO_OWNER = "2noise"
REPO_NAME = "ChatTTS"
```
### 5.3. Executar a coleta
No terminal, a partir da raiz do projeto:
```bash
cd src/PRs_comments
python extract_pr_comments.py
# ou python3 extract_pr_comments.py
```
O script:
1. Mostra o progresso dos PRs que est√£o sendo processados;
2. Cria um arquivo .json no mesmo diret√≥rio src/PRs_comments.
O nome do arquivo segue o padr√£o:
```text
pr_comments_<owner>_<repo>_<state>_nobots_<True/False>.json
```
Se quiser usar esse novo arquivo nos modelos, voc√™ pode:
- renome√°-lo para `"pr_comments_2noise_ChatTTS_closed_nobots_True.json"`, ou alterar o nome do arquivo em `"INPUT_FILE"` nos scripts:
1. `"src/models/BERTweet/analise_bertweet.py"`
2. `"src/models/Multilingual/analyzeMultilingual.py"`
3. `"src/models/Roberta/analyzeRobertaBase.py"`

Depois disso, basta repetir a execu√ß√£o da se√ß√£o 2 E os modelos passar√£o a analisar os coment√°rios do novo reposit√≥rio escolhido.
